This demonstration shows SaveMyAttachments and how we've implemented Google's recommended narrower scopes using the Advanced Drive Service.

First, the authorization flow. When opening SaveMyAttachments for the first time, the consent screen appears. Notice the scopes being requested. Gmail readonly to read emails. Drive file, which only allows access to files the app creates, not the user's entire Drive. Spreadsheets current only, which limits access to just this spreadsheet, not all of the user's spreadsheets. And additional script scopes for external requests and UI. These are the minimum necessary scopes, exactly as Google recommended.

The user clicks Allow to grant these permissions.

Now let me show the default state. Opening the Settings panel, you can see that no Drive folder is configured yet, and AI summarization is disabled by default. No email processing happens until the user explicitly sets things up.

Let me configure the Drive folder. Clicking Set Up Drive Folder creates a new folder called SaveMyAttachments in the user's Drive. This is important: as recommended by Google for Workspace Add-ons, we use the Advanced Drive Service instead of DriveApp. The app creates its own folder rather than browsing the user's existing folders. This is why the drive file scope is sufficient. The app only accesses files and folders it creates.

Now I'll enable the AI feature. This is completely optional. Checking Enable AI Summarization requires the user to provide their own OpenRouter API key. The user creates their own account at OpenRouter and generates their own key. The developer never has access to this key.

Looking at the model dropdown, you can see that DeepSeek models are not available. They have been completely removed from the options. This addresses Google's concern about data being used for AI training.

Saving the settings, let me now process some emails. Clicking Process New Emails Now triggers the email processing. The app reads emails from Gmail using the readonly scope, saves any attachments to the app-created Drive folder, and logs the results to this spreadsheet.

Looking at the spreadsheet, you can see new rows with email metadata: date, sender, subject, AI summary, and links to the saved files. Clicking a Drive link opens the file in the SaveMyAttachments folder that the app created.

Let me verify the data segregation. Opening the Apps Script editor, looking at the OpenRouterService file, you can see the DeepSeek blocking code. Any attempt to use a DeepSeek model is blocked and returns an error message. This protection exists at multiple levels in the code.

In summary: We've implemented all of Google's recommendations. The app uses drive file scope, not full Drive access, by using the Advanced Drive Service to create its own folder. It uses spreadsheets current only, not full Sheets access, so the Editor Add-on can only access the active spreadsheet where it runs. AI features are opt-in, require the user's own API key, and DeepSeek models are blocked. Complete data segregation is maintained throughout.

This concludes the demonstration of SaveMyAttachments with narrower scopes.
