# OAuth Scope Justifications for OAuth Consent Screen
**Project:** SaveMyAttachments
**Date:** November 24, 2025

---

## JUSTIFICATION 1: spreadsheets + script.external_request
**Character Limit:** 1000 characters
**Character Count:** 998 characters

---

For .../auth/spreadsheets scope:
This scope enables logging of email metadata (date, sender, subject, attachment count) to user-specified Google Sheets. Users provide existing spreadsheet URLs in their configuration, and the app appends one row per processed email. The drive.file scope is insufficient because: (1) Users want to use their existing business spreadsheets with existing formulas and charts, not app-created sheets; (2) Users provide spreadsheet URLs as configuration settings (not via Google Picker file selection); (3) Google Picker is not viable in Apps Script sidebar context due to iframe sandboxing. The app only writes to the specific user-configured spreadsheet and does not read existing data or access other sheets.

For .../auth/script.external_request scope:
This scope enables optional AI-powered email summarization via OpenRouter.ai (an API gateway). This feature is disabled by default and requires users to provide their own OpenRouter API keys. Email content is sent directly from the user's Apps Script environment to the user's OpenRouter account with zero developer access. No data is stored on external servers. Users control which AI models process their data (Claude, GPT-4, or Gemini only).

---

## JUSTIFICATION 2: gmail.readonly
**Character Limit:** Typically 1000 characters (confirm in UI)
**Character Count:** 547 characters

---

For .../auth/gmail.readonly scope:
This scope enables reading email messages and metadata (sender, subject, date, body text) to back up emails and attachments to Google Drive. The app processes emails based on user-defined Gmail search filters (e.g., "from:client@company.com has:attachment"). Email content is read to: (1) Convert emails to PDF/HTML/text format for archival; (2) Extract and save attachments to Drive; (3) Generate optional AI summaries (if user enables and provides their own API key); (4) Log email metadata to Google Sheets. The app only reads emails matching user filters and never modifies or deletes emails.

---

## COPY/PASTE INSTRUCTIONS

When filling out the OAuth Consent Screen:

### For "How will the scopes be used?" field (covers spreadsheets + script.external_request):

Copy everything between the arrows below (998 chars):

⬇️ START ⬇️

For .../auth/spreadsheets scope:
This scope enables logging of email metadata (date, sender, subject, attachment count) to user-specified Google Sheets. Users provide existing spreadsheet URLs in their configuration, and the app appends one row per processed email. The drive.file scope is insufficient because: (1) Users want to use their existing business spreadsheets with existing formulas and charts, not app-created sheets; (2) Users provide spreadsheet URLs as configuration settings (not via Google Picker file selection); (3) Google Picker is not viable in Apps Script sidebar context due to iframe sandboxing. The app only writes to the specific user-configured spreadsheet and does not read existing data or access other sheets.

For .../auth/script.external_request scope:
This scope enables optional AI-powered email summarization via OpenRouter.ai (an API gateway). This feature is disabled by default and requires users to provide their own OpenRouter API keys. Email content is sent directly from the user's Apps Script environment to the user's OpenRouter account with zero developer access. No data is stored on external servers. Users control which AI models process their data (Claude, GPT-4, or Gemini only).

⬆️ END ⬆️

---

### For "What features will you use?" field (gmail.readonly):

Copy everything between the arrows below (547 chars):

⬇️ START ⬇️

For .../auth/gmail.readonly scope:
This scope enables reading email messages and metadata (sender, subject, date, body text) to back up emails and attachments to Google Drive. The app processes emails based on user-defined Gmail search filters (e.g., "from:client@company.com has:attachment"). Email content is read to: (1) Convert emails to PDF/HTML/text format for archival; (2) Extract and save attachments to Drive; (3) Generate optional AI summaries (if user enables and provides their own API key); (4) Log email metadata to Google Sheets. The app only reads emails matching user filters and never modifies or deletes emails.

⬆️ END ⬆️

---

## VERIFICATION

Before submitting, verify:
- ✅ Character counts are within limits
- ✅ All scopes mentioned (spreadsheets, script.external_request, gmail.readonly)
- ✅ Clear explanation why drive.file won't work for spreadsheets
- ✅ Data segregation explained (user's API key, user's account)
- ✅ AI feature is opt-in only
- ✅ No training on user data (Claude/GPT/Gemini only)

---

**Next Step:** Copy and paste these justifications into the OAuth Consent Screen form in Google Cloud Console
